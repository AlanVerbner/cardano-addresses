<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Cardano.Codec.Cbor</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Cardano.Codec.Cbor.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">cardano-addresses-1.0.0: Library utilities for mnemonic generation and address derivation.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>&#169; 2018-2020 IOHK</td></tr><tr><th>License</th><td>Apache-2.0</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Cardano.Codec.Cbor</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Encoders</a></li><li><a href="#g:2">Decoders</a></li><li><a href="#g:3">Reexports from CBOR</a></li><li><a href="#g:4">Useful helpers</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>These are (partial) CBOR decoders for Byron binary types. Note that we
 ignore most of the block's and header's content and only retrieve the pieces
 of information relevant to us, wallet (we do assume a trusted node and
 therefore, we needn't to care about verifying signatures and blocks
 themselves).</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:encodeAddress">encodeAddress</a> :: XPub -&gt; [Encoding] -&gt; Encoding</li><li class="src short"><a href="#v:encodeAttributes">encodeAttributes</a> :: [Encoding] -&gt; Encoding</li><li class="src short"><a href="#v:encodeDerivationPathAttr">encodeDerivationPathAttr</a> :: ScrubbedBytes -&gt; <a href="Cardano-Address-Derivation.html#t:Index" title="Cardano.Address.Derivation">Index</a> <a href="Cardano-Address-Derivation.html#v:WholeDomain" title="Cardano.Address.Derivation">WholeDomain</a> <a href="Cardano-Address-Derivation.html#v:AccountK" title="Cardano.Address.Derivation">AccountK</a> -&gt; <a href="Cardano-Address-Derivation.html#t:Index" title="Cardano.Address.Derivation">Index</a> <a href="Cardano-Address-Derivation.html#v:WholeDomain" title="Cardano.Address.Derivation">WholeDomain</a> <a href="Cardano-Address-Derivation.html#v:AddressK" title="Cardano.Address.Derivation">AddressK</a> -&gt; Encoding</li><li class="src short"><a href="#v:encodeProtocolMagicAttr">encodeProtocolMagicAttr</a> :: <a href="Cardano-Address.html#t:ProtocolMagic" title="Cardano.Address">ProtocolMagic</a> -&gt; Encoding</li><li class="src short"><a href="#v:decodeAddress">decodeAddress</a> :: Decoder s <a href="Cardano-Address.html#t:Address" title="Cardano.Address">Address</a></li><li class="src short"><a href="#v:decodeAddressDerivationPath">decodeAddressDerivationPath</a> :: ScrubbedBytes -&gt; Decoder s (<a href="../base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> (<a href="Cardano-Address-Derivation.html#t:Index" title="Cardano.Address.Derivation">Index</a> <a href="Cardano-Address-Derivation.html#v:WholeDomain" title="Cardano.Address.Derivation">WholeDomain</a> <a href="Cardano-Address-Derivation.html#v:AccountK" title="Cardano.Address.Derivation">AccountK</a>, <a href="Cardano-Address-Derivation.html#t:Index" title="Cardano.Address.Derivation">Index</a> <a href="Cardano-Address-Derivation.html#v:WholeDomain" title="Cardano.Address.Derivation">WholeDomain</a> <a href="Cardano-Address-Derivation.html#v:AddressK" title="Cardano.Address.Derivation">AddressK</a>))</li><li class="src short"><a href="#v:decodeAddressPayload">decodeAddressPayload</a> :: Decoder s <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:decodeAllAttributes">decodeAllAttributes</a> :: Decoder s [(<a href="../base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a>, <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>)]</li><li class="src short"><a href="#v:decodeDerivationPathAttr">decodeDerivationPathAttr</a> :: ScrubbedBytes -&gt; [(<a href="../base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a>, <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>)] -&gt; Decoder s (<a href="../base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> (<a href="Cardano-Address-Derivation.html#t:Index" title="Cardano.Address.Derivation">Index</a> <a href="Cardano-Address-Derivation.html#v:WholeDomain" title="Cardano.Address.Derivation">WholeDomain</a> <a href="Cardano-Address-Derivation.html#v:AccountK" title="Cardano.Address.Derivation">AccountK</a>, <a href="Cardano-Address-Derivation.html#t:Index" title="Cardano.Address.Derivation">Index</a> <a href="Cardano-Address-Derivation.html#v:WholeDomain" title="Cardano.Address.Derivation">WholeDomain</a> <a href="Cardano-Address-Derivation.html#v:AddressK" title="Cardano.Address.Derivation">AddressK</a>))</li><li class="src short"><a href="#v:decodeProtocolMagicAttr">decodeProtocolMagicAttr</a> :: Decoder s (<a href="../base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> <a href="Cardano-Address.html#t:ProtocolMagic" title="Cardano.Address">ProtocolMagic</a>)</li><li class="src short"><a href="#v:deserialiseCbor">deserialiseCbor</a> :: (<span class="keyword">forall</span> s. Decoder s a) -&gt; <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> a</li><li class="src short"><a href="#v:unsafeDeserialiseCbor">unsafeDeserialiseCbor</a> :: <a href="../base-4.12.0.0/GHC-Stack.html#t:HasCallStack" title="GHC.Stack">HasCallStack</a> =&gt; (<span class="keyword">forall</span> s. Decoder s a) -&gt; <a href="../bytestring-0.10.8.2/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a> -&gt; a</li><li class="src short"><a href="#v:encodeBytes">encodeBytes</a> :: <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; Encoding</li><li class="src short"><a href="#v:toStrictByteString">toStrictByteString</a> :: Encoding -&gt; <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:toLazyByteString">toLazyByteString</a> :: Encoding -&gt; <a href="../bytestring-0.10.8.2/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a></li><li class="src short"><a href="#v:addressToText">addressToText</a> :: <a href="Cardano-Address.html#t:Address" title="Cardano.Address">Address</a> -&gt; <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Encoders</h1></a><div class="top"><p class="src"><a id="v:encodeAddress" class="def">encodeAddress</a> :: XPub -&gt; [Encoding] -&gt; Encoding <a href="src/Cardano.Codec.Cbor.html#encodeAddress" class="link">Source</a> <a href="#v:encodeAddress" class="selflink">#</a></p><div class="doc"><p>Encode a public key to a corresponding Cardano Address. The encoding of the
 attributes part of an address is left out to the caller; This allows for
 distinguishing between Sequential and Random addresses (the former doesn't
 have any attributes to encode).</p><pre>-- Old / Random Addresses
let encodeAddrAttributes = mempty
     &lt;&gt; CBOR.encodeMapLen 1
     &lt;&gt; CBOR.encodeWord8 1
     &lt;&gt; encodeDerivationPath (hdPassphrase rootXPub) accIx addrIx
let addr = encodeAddress xpub encodeAddrAttributes

-- New / Sequential Addresses
let encodeAddrAttributes = mempty &lt;&gt; CBOR.encodeMapLen 0
let addr = encodeAddress xpub encodeAddrAttributes
</pre><p>Note that we are passing the behavior to encode attributes as a parameter
 here and do not handle multiple cases in <code><a href="Cardano-Codec-Cbor.html#v:encodeAddress" title="Cardano.Codec.Cbor">encodeAddress</a></code> itself for multiple
 reasons:</p><ul><li>Inversion of control gives us a nicer implementation overall</li><li>Encoding attributes for Random addresses requires more context than just
   the public key (like the wallet root id and some extra logic for encoding
   passphrases). This is just scheme-specific and is better left out of this
   particular function</li></ul></div></div><div class="top"><p class="src"><a id="v:encodeAttributes" class="def">encodeAttributes</a> :: [Encoding] -&gt; Encoding <a href="src/Cardano.Codec.Cbor.html#encodeAttributes" class="link">Source</a> <a href="#v:encodeAttributes" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:encodeDerivationPathAttr" class="def">encodeDerivationPathAttr</a> :: ScrubbedBytes -&gt; <a href="Cardano-Address-Derivation.html#t:Index" title="Cardano.Address.Derivation">Index</a> <a href="Cardano-Address-Derivation.html#v:WholeDomain" title="Cardano.Address.Derivation">WholeDomain</a> <a href="Cardano-Address-Derivation.html#v:AccountK" title="Cardano.Address.Derivation">AccountK</a> -&gt; <a href="Cardano-Address-Derivation.html#t:Index" title="Cardano.Address.Derivation">Index</a> <a href="Cardano-Address-Derivation.html#v:WholeDomain" title="Cardano.Address.Derivation">WholeDomain</a> <a href="Cardano-Address-Derivation.html#v:AddressK" title="Cardano.Address.Derivation">AddressK</a> -&gt; Encoding <a href="src/Cardano.Codec.Cbor.html#encodeDerivationPathAttr" class="link">Source</a> <a href="#v:encodeDerivationPathAttr" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:encodeProtocolMagicAttr" class="def">encodeProtocolMagicAttr</a> :: <a href="Cardano-Address.html#t:ProtocolMagic" title="Cardano.Address">ProtocolMagic</a> -&gt; Encoding <a href="src/Cardano.Codec.Cbor.html#encodeProtocolMagicAttr" class="link">Source</a> <a href="#v:encodeProtocolMagicAttr" class="selflink">#</a></p></div><a href="#g:2" id="g:2"><h1>Decoders</h1></a><div class="top"><p class="src"><a id="v:decodeAddress" class="def">decodeAddress</a> :: Decoder s <a href="Cardano-Address.html#t:Address" title="Cardano.Address">Address</a> <a href="src/Cardano.Codec.Cbor.html#decodeAddress" class="link">Source</a> <a href="#v:decodeAddress" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:decodeAddressDerivationPath" class="def">decodeAddressDerivationPath</a> :: ScrubbedBytes -&gt; Decoder s (<a href="../base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> (<a href="Cardano-Address-Derivation.html#t:Index" title="Cardano.Address.Derivation">Index</a> <a href="Cardano-Address-Derivation.html#v:WholeDomain" title="Cardano.Address.Derivation">WholeDomain</a> <a href="Cardano-Address-Derivation.html#v:AccountK" title="Cardano.Address.Derivation">AccountK</a>, <a href="Cardano-Address-Derivation.html#t:Index" title="Cardano.Address.Derivation">Index</a> <a href="Cardano-Address-Derivation.html#v:WholeDomain" title="Cardano.Address.Derivation">WholeDomain</a> <a href="Cardano-Address-Derivation.html#v:AddressK" title="Cardano.Address.Derivation">AddressK</a>)) <a href="src/Cardano.Codec.Cbor.html#decodeAddressDerivationPath" class="link">Source</a> <a href="#v:decodeAddressDerivationPath" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:decodeAddressPayload" class="def">decodeAddressPayload</a> :: Decoder s <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Cardano.Codec.Cbor.html#decodeAddressPayload" class="link">Source</a> <a href="#v:decodeAddressPayload" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:decodeAllAttributes" class="def">decodeAllAttributes</a> :: Decoder s [(<a href="../base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a>, <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>)] <a href="src/Cardano.Codec.Cbor.html#decodeAllAttributes" class="link">Source</a> <a href="#v:decodeAllAttributes" class="selflink">#</a></p><div class="doc"><p>The attributes are pairs of numeric tags and bytes, where the bytes will be
 CBOR-encoded stuff. This decoder does not enforce &quot;canonicity&quot; of entries.</p></div></div><div class="top"><p class="src"><a id="v:decodeDerivationPathAttr" class="def">decodeDerivationPathAttr</a> :: ScrubbedBytes -&gt; [(<a href="../base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a>, <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>)] -&gt; Decoder s (<a href="../base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> (<a href="Cardano-Address-Derivation.html#t:Index" title="Cardano.Address.Derivation">Index</a> <a href="Cardano-Address-Derivation.html#v:WholeDomain" title="Cardano.Address.Derivation">WholeDomain</a> <a href="Cardano-Address-Derivation.html#v:AccountK" title="Cardano.Address.Derivation">AccountK</a>, <a href="Cardano-Address-Derivation.html#t:Index" title="Cardano.Address.Derivation">Index</a> <a href="Cardano-Address-Derivation.html#v:WholeDomain" title="Cardano.Address.Derivation">WholeDomain</a> <a href="Cardano-Address-Derivation.html#v:AddressK" title="Cardano.Address.Derivation">AddressK</a>)) <a href="src/Cardano.Codec.Cbor.html#decodeDerivationPathAttr" class="link">Source</a> <a href="#v:decodeDerivationPathAttr" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:decodeProtocolMagicAttr" class="def">decodeProtocolMagicAttr</a> :: Decoder s (<a href="../base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> <a href="Cardano-Address.html#t:ProtocolMagic" title="Cardano.Address">ProtocolMagic</a>) <a href="src/Cardano.Codec.Cbor.html#decodeProtocolMagicAttr" class="link">Source</a> <a href="#v:decodeProtocolMagicAttr" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:deserialiseCbor" class="def">deserialiseCbor</a> :: (<span class="keyword">forall</span> s. Decoder s a) -&gt; <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> a <a href="src/Cardano.Codec.Cbor.html#deserialiseCbor" class="link">Source</a> <a href="#v:deserialiseCbor" class="selflink">#</a></p><div class="doc"><p>Shortcut for deserialising a strict <code>Bytestring</code> with the given decoder.</p></div></div><div class="top"><p class="src"><a id="v:unsafeDeserialiseCbor" class="def">unsafeDeserialiseCbor</a> :: <a href="../base-4.12.0.0/GHC-Stack.html#t:HasCallStack" title="GHC.Stack">HasCallStack</a> =&gt; (<span class="keyword">forall</span> s. Decoder s a) -&gt; <a href="../bytestring-0.10.8.2/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a> -&gt; a <a href="src/Cardano.Codec.Cbor.html#unsafeDeserialiseCbor" class="link">Source</a> <a href="#v:unsafeDeserialiseCbor" class="selflink">#</a></p><div class="doc"><p>CBOR deserialise without error handling - handy for prototypes or testing.</p></div></div><a href="#g:3" id="g:3"><h1>Reexports from CBOR</h1></a><div class="top"><p class="src"><a id="v:encodeBytes" class="def">encodeBytes</a> :: <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; Encoding <a href="#v:encodeBytes" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:toStrictByteString" class="def">toStrictByteString</a> :: Encoding -&gt; <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="#v:toStrictByteString" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:toLazyByteString" class="def">toLazyByteString</a> :: Encoding -&gt; <a href="../bytestring-0.10.8.2/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a> <a href="#v:toLazyByteString" class="selflink">#</a></p></div><a href="#g:4" id="g:4"><h1>Useful helpers</h1></a><div class="top"><p class="src"><a id="v:addressToText" class="def">addressToText</a> :: <a href="Cardano-Address.html#t:Address" title="Cardano.Address">Address</a> -&gt; <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="src/Cardano.Codec.Cbor.html#addressToText" class="link">Source</a> <a href="#v:addressToText" class="selflink">#</a></p><div class="doc"><p>Transform address to text</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>